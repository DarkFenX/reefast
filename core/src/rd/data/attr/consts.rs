use itertools::Itertools;

use crate::{ac, ad::AAttrId, rd::RAttrKey, util::RMap};

#[derive(Clone)]
pub(crate) struct RAttrConsts {
    pub(crate) activation_blocked: Option<RAttrKey>,
    pub(crate) agility: Option<RAttrKey>,
    pub(crate) allow_in_fully_corrupted_hisec: Option<RAttrKey>,
    pub(crate) allow_in_fully_corrupted_lowsec: Option<RAttrKey>,
    pub(crate) allowed_drone_group1: Option<RAttrKey>,
    pub(crate) allowed_drone_group2: Option<RAttrKey>,
    pub(crate) aoe_cloud_size: Option<RAttrKey>,
    pub(crate) aoe_dmg_reduction_factor: Option<RAttrKey>,
    pub(crate) aoe_velocity: Option<RAttrKey>,
    pub(crate) armor_dmg_amount: Option<RAttrKey>,
    pub(crate) armor_em_dmg_resonance: Option<RAttrKey>,
    pub(crate) armor_expl_dmg_resonance: Option<RAttrKey>,
    pub(crate) armor_hp: Option<RAttrKey>,
    pub(crate) armor_kin_dmg_resonance: Option<RAttrKey>,
    pub(crate) armor_therm_dmg_resonance: Option<RAttrKey>,
    pub(crate) boosterness: Option<RAttrKey>,
    pub(crate) can_fit_ship_group1: Option<RAttrKey>,
    pub(crate) can_fit_ship_group2: Option<RAttrKey>,
    pub(crate) can_fit_ship_group3: Option<RAttrKey>,
    pub(crate) can_fit_ship_group4: Option<RAttrKey>,
    pub(crate) can_fit_ship_group5: Option<RAttrKey>,
    pub(crate) can_fit_ship_group6: Option<RAttrKey>,
    pub(crate) can_fit_ship_group7: Option<RAttrKey>,
    pub(crate) can_fit_ship_group8: Option<RAttrKey>,
    pub(crate) can_fit_ship_group9: Option<RAttrKey>,
    pub(crate) can_fit_ship_group10: Option<RAttrKey>,
    pub(crate) can_fit_ship_group11: Option<RAttrKey>,
    pub(crate) can_fit_ship_group12: Option<RAttrKey>,
    pub(crate) can_fit_ship_group13: Option<RAttrKey>,
    pub(crate) can_fit_ship_group14: Option<RAttrKey>,
    pub(crate) can_fit_ship_group15: Option<RAttrKey>,
    pub(crate) can_fit_ship_group16: Option<RAttrKey>,
    pub(crate) can_fit_ship_group17: Option<RAttrKey>,
    pub(crate) can_fit_ship_group18: Option<RAttrKey>,
    pub(crate) can_fit_ship_group19: Option<RAttrKey>,
    pub(crate) can_fit_ship_group20: Option<RAttrKey>,
    pub(crate) can_fit_ship_type1: Option<RAttrKey>,
    pub(crate) can_fit_ship_type2: Option<RAttrKey>,
    pub(crate) can_fit_ship_type3: Option<RAttrKey>,
    pub(crate) can_fit_ship_type4: Option<RAttrKey>,
    pub(crate) can_fit_ship_type5: Option<RAttrKey>,
    pub(crate) can_fit_ship_type6: Option<RAttrKey>,
    pub(crate) can_fit_ship_type7: Option<RAttrKey>,
    pub(crate) can_fit_ship_type8: Option<RAttrKey>,
    pub(crate) can_fit_ship_type9: Option<RAttrKey>,
    pub(crate) can_fit_ship_type10: Option<RAttrKey>,
    pub(crate) can_fit_ship_type11: Option<RAttrKey>,
    pub(crate) can_fit_ship_type12: Option<RAttrKey>,
    pub(crate) capacitor_bonus: Option<RAttrKey>,
    pub(crate) capacitor_capacity: Option<RAttrKey>,
    pub(crate) capacity: Option<RAttrKey>,
    pub(crate) charge_group1: Option<RAttrKey>,
    pub(crate) charge_group2: Option<RAttrKey>,
    pub(crate) charge_group3: Option<RAttrKey>,
    pub(crate) charge_group4: Option<RAttrKey>,
    pub(crate) charge_group5: Option<RAttrKey>,
    pub(crate) charge_rate: Option<RAttrKey>,
    pub(crate) charge_size: Option<RAttrKey>,
    pub(crate) charged_armor_dmg_mult: Option<RAttrKey>,
    pub(crate) cpu: Option<RAttrKey>,
    pub(crate) cpu_output: Option<RAttrKey>,
    pub(crate) crystal_volatility_chance: Option<RAttrKey>,
    pub(crate) crystal_volatility_dmg: Option<RAttrKey>,
    pub(crate) crystals_get_damaged: Option<RAttrKey>,
    pub(crate) disallow_assistance: Option<RAttrKey>,
    pub(crate) disallow_in_empire_space: Option<RAttrKey>,
    pub(crate) disallow_in_hazard: Option<RAttrKey>,
    pub(crate) disallow_in_hisec: Option<RAttrKey>,
    pub(crate) disallow_offensive_modifiers: Option<RAttrKey>,
    pub(crate) disallow_vs_ew_immune_tgt: Option<RAttrKey>,
    pub(crate) dmg_delay_duration: Option<RAttrKey>,
    pub(crate) dmg_mult: Option<RAttrKey>,
    pub(crate) dmg_mult_bonus_max: Option<RAttrKey>,
    pub(crate) dmg_mult_bonus_per_cycle: Option<RAttrKey>,
    pub(crate) doomsday_aoe_duration: Option<RAttrKey>,
    pub(crate) doomsday_aoe_range: Option<RAttrKey>,
    pub(crate) doomsday_aoe_sig_radius: Option<RAttrKey>,
    pub(crate) doomsday_dmg_cycle_time: Option<RAttrKey>,
    pub(crate) doomsday_dmg_duration: Option<RAttrKey>,
    pub(crate) doomsday_energy_neut_amount: Option<RAttrKey>,
    pub(crate) doomsday_energy_neut_radius: Option<RAttrKey>,
    pub(crate) doomsday_energy_neut_resist_id: Option<RAttrKey>,
    pub(crate) doomsday_energy_neut_sig_radius: Option<RAttrKey>,
    pub(crate) doomsday_warning_duration: Option<RAttrKey>,
    pub(crate) dot_duration: Option<RAttrKey>,
    pub(crate) dot_max_dmg_per_tick: Option<RAttrKey>,
    pub(crate) dot_max_hp_perc_per_tick: Option<RAttrKey>,
    pub(crate) drone_bandwidth: Option<RAttrKey>,
    pub(crate) drone_bandwidth_used: Option<RAttrKey>,
    pub(crate) drone_capacity: Option<RAttrKey>,
    pub(crate) drone_control_distance: Option<RAttrKey>,
    pub(crate) ecm_jam_duration: Option<RAttrKey>,
    pub(crate) em_dmg: Option<RAttrKey>,
    pub(crate) em_dmg_resonance: Option<RAttrKey>,
    pub(crate) emp_field_range: Option<RAttrKey>,
    pub(crate) energy_neut_amount: Option<RAttrKey>,
    pub(crate) energy_neut_sig_resolution: Option<RAttrKey>,
    pub(crate) energy_warfare_resist: Option<RAttrKey>,
    pub(crate) entity_cruise_speed: Option<RAttrKey>,
    pub(crate) entity_max_velocity_sig_radius_mult: Option<RAttrKey>,
    pub(crate) expl_dmg: Option<RAttrKey>,
    pub(crate) expl_dmg_resonance: Option<RAttrKey>,
    pub(crate) explosion_delay: Option<RAttrKey>,
    pub(crate) fits_to_ship_type: Option<RAttrKey>,
    pub(crate) ftr_capacity: Option<RAttrKey>,
    pub(crate) ftr_heavy_slots: Option<RAttrKey>,
    pub(crate) ftr_light_slots: Option<RAttrKey>,
    pub(crate) ftr_sq_is_heavy: Option<RAttrKey>,
    pub(crate) ftr_sq_is_light: Option<RAttrKey>,
    pub(crate) ftr_sq_is_st_heavy: Option<RAttrKey>,
    pub(crate) ftr_sq_is_st_light: Option<RAttrKey>,
    pub(crate) ftr_sq_is_st_support: Option<RAttrKey>,
    pub(crate) ftr_sq_is_support: Option<RAttrKey>,
    pub(crate) ftr_sq_max_size: Option<RAttrKey>,
    pub(crate) ftr_sq_size: Option<RAttrKey>,
    pub(crate) ftr_st_heavy_slots: Option<RAttrKey>,
    pub(crate) ftr_st_light_slots: Option<RAttrKey>,
    pub(crate) ftr_st_support_slots: Option<RAttrKey>,
    pub(crate) ftr_support_slots: Option<RAttrKey>,
    pub(crate) ftr_tubes: Option<RAttrKey>,
    pub(crate) hi_slots: Option<RAttrKey>,
    pub(crate) hisec_modifier: Option<RAttrKey>,
    pub(crate) hp: Option<RAttrKey>,
    pub(crate) implantness: Option<RAttrKey>,
    pub(crate) kin_dmg: Option<RAttrKey>,
    pub(crate) kin_dmg_resonance: Option<RAttrKey>,
    pub(crate) launcher_group: Option<RAttrKey>,
    pub(crate) launcher_group2: Option<RAttrKey>,
    pub(crate) launcher_group3: Option<RAttrKey>,
    pub(crate) launcher_group4: Option<RAttrKey>,
    pub(crate) launcher_group5: Option<RAttrKey>,
    pub(crate) launcher_group6: Option<RAttrKey>,
    pub(crate) launcher_slots_left: Option<RAttrKey>,
    pub(crate) low_slots: Option<RAttrKey>,
    pub(crate) lowsec_modifier: Option<RAttrKey>,
    pub(crate) mass: Option<RAttrKey>,
    pub(crate) max_active_drones: Option<RAttrKey>,
    pub(crate) max_directional_scan_range: Option<RAttrKey>,
    pub(crate) max_fof_tgt_range: Option<RAttrKey>,
    pub(crate) max_group_active: Option<RAttrKey>,
    pub(crate) max_group_fitted: Option<RAttrKey>,
    pub(crate) max_group_online: Option<RAttrKey>,
    pub(crate) max_locked_targets: Option<RAttrKey>,
    pub(crate) max_range: Option<RAttrKey>,
    pub(crate) max_subsystems: Option<RAttrKey>,
    pub(crate) max_target_range: Option<RAttrKey>,
    pub(crate) max_type_fitted: Option<RAttrKey>,
    pub(crate) max_velocity: Option<RAttrKey>,
    pub(crate) med_slots: Option<RAttrKey>,
    pub(crate) mining_amount: Option<RAttrKey>,
    pub(crate) mining_crit_bonus_yield: Option<RAttrKey>,
    pub(crate) mining_crit_chance: Option<RAttrKey>,
    pub(crate) mining_waste_probability: Option<RAttrKey>,
    pub(crate) mining_wasted_volume_mult: Option<RAttrKey>,
    pub(crate) mod_reactivation_delay: Option<RAttrKey>,
    pub(crate) nos_override: Option<RAttrKey>,
    pub(crate) nullsec_modifier: Option<RAttrKey>,
    pub(crate) online_max_security_class: Option<RAttrKey>,
    pub(crate) optimal_sig_radius: Option<RAttrKey>,
    pub(crate) pilot_security_status: Option<RAttrKey>,
    pub(crate) power: Option<RAttrKey>,
    pub(crate) power_output: Option<RAttrKey>,
    pub(crate) power_transfer_amount: Option<RAttrKey>,
    pub(crate) radius: Option<RAttrKey>,
    pub(crate) recharge_rate: Option<RAttrKey>,
    pub(crate) reload_time: Option<RAttrKey>,
    pub(crate) remote_resist_id: Option<RAttrKey>,
    pub(crate) rep_mult_bonus_max: Option<RAttrKey>,
    pub(crate) rep_mult_bonus_per_cycle: Option<RAttrKey>,
    pub(crate) required_thermodynamics_skill: Option<RAttrKey>,
    pub(crate) resist_shift_amount: Option<RAttrKey>,
    pub(crate) rig_size: Option<RAttrKey>,
    pub(crate) scan_gravimetric_strength: Option<RAttrKey>,
    pub(crate) scan_gravimetric_strength_bonus: Option<RAttrKey>,
    pub(crate) scan_ladar_strength: Option<RAttrKey>,
    pub(crate) scan_ladar_strength_bonus: Option<RAttrKey>,
    pub(crate) scan_magnetometric_strength: Option<RAttrKey>,
    pub(crate) scan_magnetometric_strength_bonus: Option<RAttrKey>,
    pub(crate) scan_radar_strength: Option<RAttrKey>,
    pub(crate) scan_radar_strength_bonus: Option<RAttrKey>,
    pub(crate) scan_resolution: Option<RAttrKey>,
    pub(crate) security_modifier: Option<RAttrKey>,
    pub(crate) service_slots: Option<RAttrKey>,
    pub(crate) shield_bonus: Option<RAttrKey>,
    pub(crate) shield_capacity: Option<RAttrKey>,
    pub(crate) shield_em_dmg_resonance: Option<RAttrKey>,
    pub(crate) shield_expl_dmg_resonance: Option<RAttrKey>,
    pub(crate) shield_kin_dmg_resonance: Option<RAttrKey>,
    pub(crate) shield_recharge_rate: Option<RAttrKey>,
    pub(crate) shield_therm_dmg_resonance: Option<RAttrKey>,
    pub(crate) sig_radius: Option<RAttrKey>,
    pub(crate) skill_level: Option<RAttrKey>,
    pub(crate) speed_boost_factor: Option<RAttrKey>,
    pub(crate) speed_factor: Option<RAttrKey>,
    pub(crate) struct_dmg_amount: Option<RAttrKey>,
    pub(crate) subsystem_slot: Option<RAttrKey>,
    pub(crate) therm_dmg: Option<RAttrKey>,
    pub(crate) therm_dmg_resonance: Option<RAttrKey>,
    pub(crate) turret_slots_left: Option<RAttrKey>,
    pub(crate) upgrade_capacity: Option<RAttrKey>,
    pub(crate) upgrade_cost: Option<RAttrKey>,
    pub(crate) upgrade_slots_left: Option<RAttrKey>,
    pub(crate) volume: Option<RAttrKey>,
    pub(crate) warp_capacitor_need: Option<RAttrKey>,
    pub(crate) warp_scramble_status: Option<RAttrKey>,
    pub(crate) warp_speed_mult: Option<RAttrKey>,
    // Derived data
    pub(crate) limited_precision: Vec<RAttrKey>,
    pub(crate) buff_merge_ids_strs: Vec<(RAttrKey, RAttrKey)>,
    pub(crate) buff_merge_ids: Vec<RAttrKey>,
}
impl RAttrConsts {
    pub(in crate::rd) fn new(attr_id_key_map: &RMap<AAttrId, RAttrKey>) -> Self {
        let limited_precision = ac::extras::LIMITED_PRECISION_ATTR_IDS
            .iter()
            .filter_map(|v| attr_id_key_map.get(v).copied())
            .collect();
        let buff_merge_id_str = ac::extras::BUFF_MERGE_ATTRS
            .iter()
            .filter_map(
                |(buff_id, buff_str)| match (attr_id_key_map.get(buff_id), attr_id_key_map.get(buff_str)) {
                    (Some(&buff_id), Some(&buff_str)) => Some((buff_id, buff_str)),
                    _ => None,
                },
            )
            .collect_vec();
        // Store buff ID attribute only if there is corresponding buff strength attribute
        let buff_merge_id = buff_merge_id_str.iter().map(|(buff_id, _)| *buff_id).collect();
        Self {
            activation_blocked: attr_id_key_map.get(&ac::attrs::ACTIVATION_BLOCKED).copied(),
            agility: attr_id_key_map.get(&ac::attrs::AGILITY).copied(),
            allow_in_fully_corrupted_hisec: attr_id_key_map.get(&ac::attrs::ALLOW_IN_FULLY_CORRUPTED_HISEC).copied(),
            allow_in_fully_corrupted_lowsec: attr_id_key_map
                .get(&ac::attrs::ALLOW_IN_FULLY_CORRUPTED_LOWSEC)
                .copied(),
            allowed_drone_group1: attr_id_key_map.get(&ac::attrs::ALLOWED_DRONE_GROUP1).copied(),
            allowed_drone_group2: attr_id_key_map.get(&ac::attrs::ALLOWED_DRONE_GROUP2).copied(),
            aoe_cloud_size: attr_id_key_map.get(&ac::attrs::AOE_CLOUD_SIZE).copied(),
            aoe_dmg_reduction_factor: attr_id_key_map.get(&ac::attrs::AOE_DMG_REDUCTION_FACTOR).copied(),
            aoe_velocity: attr_id_key_map.get(&ac::attrs::AOE_VELOCITY).copied(),
            armor_dmg_amount: attr_id_key_map.get(&ac::attrs::ARMOR_DMG_AMOUNT).copied(),
            armor_em_dmg_resonance: attr_id_key_map.get(&ac::attrs::ARMOR_EM_DMG_RESONANCE).copied(),
            armor_expl_dmg_resonance: attr_id_key_map.get(&ac::attrs::ARMOR_EXPL_DMG_RESONANCE).copied(),
            armor_hp: attr_id_key_map.get(&ac::attrs::ARMOR_HP).copied(),
            armor_kin_dmg_resonance: attr_id_key_map.get(&ac::attrs::ARMOR_KIN_DMG_RESONANCE).copied(),
            armor_therm_dmg_resonance: attr_id_key_map.get(&ac::attrs::ARMOR_THERM_DMG_RESONANCE).copied(),
            boosterness: attr_id_key_map.get(&ac::attrs::BOOSTERNESS).copied(),
            can_fit_ship_group1: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP1).copied(),
            can_fit_ship_group2: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP2).copied(),
            can_fit_ship_group3: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP3).copied(),
            can_fit_ship_group4: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP4).copied(),
            can_fit_ship_group5: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP5).copied(),
            can_fit_ship_group6: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP6).copied(),
            can_fit_ship_group7: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP7).copied(),
            can_fit_ship_group8: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP8).copied(),
            can_fit_ship_group9: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP9).copied(),
            can_fit_ship_group10: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP10).copied(),
            can_fit_ship_group11: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP11).copied(),
            can_fit_ship_group12: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP12).copied(),
            can_fit_ship_group13: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP13).copied(),
            can_fit_ship_group14: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP14).copied(),
            can_fit_ship_group15: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP15).copied(),
            can_fit_ship_group16: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP16).copied(),
            can_fit_ship_group17: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP17).copied(),
            can_fit_ship_group18: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP18).copied(),
            can_fit_ship_group19: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP19).copied(),
            can_fit_ship_group20: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_GROUP20).copied(),
            can_fit_ship_type1: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_TYPE1).copied(),
            can_fit_ship_type2: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_TYPE2).copied(),
            can_fit_ship_type3: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_TYPE3).copied(),
            can_fit_ship_type4: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_TYPE4).copied(),
            can_fit_ship_type5: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_TYPE5).copied(),
            can_fit_ship_type6: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_TYPE6).copied(),
            can_fit_ship_type7: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_TYPE7).copied(),
            can_fit_ship_type8: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_TYPE8).copied(),
            can_fit_ship_type9: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_TYPE9).copied(),
            can_fit_ship_type10: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_TYPE10).copied(),
            can_fit_ship_type11: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_TYPE11).copied(),
            can_fit_ship_type12: attr_id_key_map.get(&ac::attrs::CAN_FIT_SHIP_TYPE12).copied(),
            capacitor_bonus: attr_id_key_map.get(&ac::attrs::CAPACITOR_BONUS).copied(),
            capacitor_capacity: attr_id_key_map.get(&ac::attrs::CAPACITOR_CAPACITY).copied(),
            capacity: attr_id_key_map.get(&ac::attrs::CAPACITY).copied(),
            charge_group1: attr_id_key_map.get(&ac::attrs::CHARGE_GROUP1).copied(),
            charge_group2: attr_id_key_map.get(&ac::attrs::CHARGE_GROUP2).copied(),
            charge_group3: attr_id_key_map.get(&ac::attrs::CHARGE_GROUP3).copied(),
            charge_group4: attr_id_key_map.get(&ac::attrs::CHARGE_GROUP4).copied(),
            charge_group5: attr_id_key_map.get(&ac::attrs::CHARGE_GROUP5).copied(),
            charge_rate: attr_id_key_map.get(&ac::attrs::CHARGE_RATE).copied(),
            charge_size: attr_id_key_map.get(&ac::attrs::CHARGE_SIZE).copied(),
            charged_armor_dmg_mult: attr_id_key_map.get(&ac::attrs::CHARGED_ARMOR_DMG_MULT).copied(),
            cpu: attr_id_key_map.get(&ac::attrs::CPU).copied(),
            cpu_output: attr_id_key_map.get(&ac::attrs::CPU_OUTPUT).copied(),
            crystal_volatility_chance: attr_id_key_map.get(&ac::attrs::CRYSTAL_VOLATILITY_CHANCE).copied(),
            crystal_volatility_dmg: attr_id_key_map.get(&ac::attrs::CRYSTAL_VOLATILITY_DMG).copied(),
            crystals_get_damaged: attr_id_key_map.get(&ac::attrs::CRYSTALS_GET_DAMAGED).copied(),
            disallow_assistance: attr_id_key_map.get(&ac::attrs::DISALLOW_ASSISTANCE).copied(),
            disallow_in_empire_space: attr_id_key_map.get(&ac::attrs::DISALLOW_IN_EMPIRE_SPACE).copied(),
            disallow_in_hazard: attr_id_key_map.get(&ac::attrs::DISALLOW_IN_HAZARD).copied(),
            disallow_in_hisec: attr_id_key_map.get(&ac::attrs::DISALLOW_IN_HISEC).copied(),
            disallow_offensive_modifiers: attr_id_key_map.get(&ac::attrs::DISALLOW_OFFENSIVE_MODIFIERS).copied(),
            disallow_vs_ew_immune_tgt: attr_id_key_map.get(&ac::attrs::DISALLOW_VS_EW_IMMUNE_TGT).copied(),
            dmg_delay_duration: attr_id_key_map.get(&ac::attrs::DMG_DELAY_DURATION).copied(),
            dmg_mult: attr_id_key_map.get(&ac::attrs::DMG_MULT).copied(),
            dmg_mult_bonus_max: attr_id_key_map.get(&ac::attrs::DMG_MULT_BONUS_MAX).copied(),
            dmg_mult_bonus_per_cycle: attr_id_key_map.get(&ac::attrs::DMG_MULT_BONUS_PER_CYCLE).copied(),
            doomsday_aoe_duration: attr_id_key_map.get(&ac::attrs::DOOMSDAY_AOE_DURATION).copied(),
            doomsday_aoe_range: attr_id_key_map.get(&ac::attrs::DOOMSDAY_AOE_RANGE).copied(),
            doomsday_aoe_sig_radius: attr_id_key_map.get(&ac::attrs::DOOMSDAY_AOE_SIG_RADIUS).copied(),
            doomsday_dmg_cycle_time: attr_id_key_map.get(&ac::attrs::DOOMSDAY_DMG_CYCLE_TIME).copied(),
            doomsday_dmg_duration: attr_id_key_map.get(&ac::attrs::DOOMSDAY_DMG_DURATION).copied(),
            doomsday_energy_neut_amount: attr_id_key_map.get(&ac::attrs::DOOMSDAY_ENERGY_NEUT_AMOUNT).copied(),
            doomsday_energy_neut_radius: attr_id_key_map.get(&ac::attrs::DOOMSDAY_ENERGY_NEUT_RADIUS).copied(),
            doomsday_energy_neut_resist_id: attr_id_key_map.get(&ac::attrs::DOOMSDAY_ENERGY_NEUT_RESIST_ID).copied(),
            doomsday_energy_neut_sig_radius: attr_id_key_map
                .get(&ac::attrs::DOOMSDAY_ENERGY_NEUT_SIG_RADIUS)
                .copied(),
            doomsday_warning_duration: attr_id_key_map.get(&ac::attrs::DOOMSDAY_WARNING_DURATION).copied(),
            dot_duration: attr_id_key_map.get(&ac::attrs::DOT_DURATION).copied(),
            dot_max_dmg_per_tick: attr_id_key_map.get(&ac::attrs::DOT_MAX_DMG_PER_TICK).copied(),
            dot_max_hp_perc_per_tick: attr_id_key_map.get(&ac::attrs::DOT_MAX_HP_PERC_PER_TICK).copied(),
            drone_bandwidth: attr_id_key_map.get(&ac::attrs::DRONE_BANDWIDTH).copied(),
            drone_bandwidth_used: attr_id_key_map.get(&ac::attrs::DRONE_BANDWIDTH_USED).copied(),
            drone_capacity: attr_id_key_map.get(&ac::attrs::DRONE_CAPACITY).copied(),
            drone_control_distance: attr_id_key_map.get(&ac::attrs::DRONE_CONTROL_DISTANCE).copied(),
            ecm_jam_duration: attr_id_key_map.get(&ac::attrs::ECM_JAM_DURATION).copied(),
            em_dmg: attr_id_key_map.get(&ac::attrs::EM_DMG).copied(),
            em_dmg_resonance: attr_id_key_map.get(&ac::attrs::EM_DMG_RESONANCE).copied(),
            emp_field_range: attr_id_key_map.get(&ac::attrs::EMP_FIELD_RANGE).copied(),
            energy_neut_amount: attr_id_key_map.get(&ac::attrs::ENERGY_NEUT_AMOUNT).copied(),
            energy_neut_sig_resolution: attr_id_key_map.get(&ac::attrs::ENERGY_NEUT_SIG_RESOLUTION).copied(),
            energy_warfare_resist: attr_id_key_map.get(&ac::attrs::ENERGY_WARFARE_RESIST).copied(),
            entity_cruise_speed: attr_id_key_map.get(&ac::attrs::ENTITY_CRUISE_SPEED).copied(),
            entity_max_velocity_sig_radius_mult: attr_id_key_map
                .get(&ac::attrs::ENTITY_MAX_VELOCITY_SIG_RADIUS_MULT)
                .copied(),
            expl_dmg: attr_id_key_map.get(&ac::attrs::EXPL_DMG).copied(),
            expl_dmg_resonance: attr_id_key_map.get(&ac::attrs::EXPL_DMG_RESONANCE).copied(),
            explosion_delay: attr_id_key_map.get(&ac::attrs::EXPLOSION_DELAY).copied(),
            fits_to_ship_type: attr_id_key_map.get(&ac::attrs::FITS_TO_SHIP_TYPE).copied(),
            ftr_capacity: attr_id_key_map.get(&ac::attrs::FTR_CAPACITY).copied(),
            ftr_heavy_slots: attr_id_key_map.get(&ac::attrs::FTR_HEAVY_SLOTS).copied(),
            ftr_light_slots: attr_id_key_map.get(&ac::attrs::FTR_LIGHT_SLOTS).copied(),
            ftr_sq_is_heavy: attr_id_key_map.get(&ac::attrs::FTR_SQ_IS_HEAVY).copied(),
            ftr_sq_is_light: attr_id_key_map.get(&ac::attrs::FTR_SQ_IS_LIGHT).copied(),
            ftr_sq_is_st_heavy: attr_id_key_map.get(&ac::attrs::FTR_SQ_IS_ST_HEAVY).copied(),
            ftr_sq_is_st_light: attr_id_key_map.get(&ac::attrs::FTR_SQ_IS_ST_LIGHT).copied(),
            ftr_sq_is_st_support: attr_id_key_map.get(&ac::attrs::FTR_SQ_IS_ST_SUPPORT).copied(),
            ftr_sq_is_support: attr_id_key_map.get(&ac::attrs::FTR_SQ_IS_SUPPORT).copied(),
            ftr_sq_max_size: attr_id_key_map.get(&ac::attrs::FTR_SQ_MAX_SIZE).copied(),
            ftr_sq_size: attr_id_key_map.get(&ac::attrs::FTR_SQ_SIZE).copied(),
            ftr_st_heavy_slots: attr_id_key_map.get(&ac::attrs::FTR_ST_HEAVY_SLOTS).copied(),
            ftr_st_light_slots: attr_id_key_map.get(&ac::attrs::FTR_ST_LIGHT_SLOTS).copied(),
            ftr_st_support_slots: attr_id_key_map.get(&ac::attrs::FTR_ST_SUPPORT_SLOTS).copied(),
            ftr_support_slots: attr_id_key_map.get(&ac::attrs::FTR_SUPPORT_SLOTS).copied(),
            ftr_tubes: attr_id_key_map.get(&ac::attrs::FTR_TUBES).copied(),
            hi_slots: attr_id_key_map.get(&ac::attrs::HI_SLOTS).copied(),
            hisec_modifier: attr_id_key_map.get(&ac::attrs::HISEC_MODIFIER).copied(),
            hp: attr_id_key_map.get(&ac::attrs::HP).copied(),
            implantness: attr_id_key_map.get(&ac::attrs::IMPLANTNESS).copied(),
            kin_dmg: attr_id_key_map.get(&ac::attrs::KIN_DMG).copied(),
            kin_dmg_resonance: attr_id_key_map.get(&ac::attrs::KIN_DMG_RESONANCE).copied(),
            launcher_group: attr_id_key_map.get(&ac::attrs::LAUNCHER_GROUP).copied(),
            launcher_group2: attr_id_key_map.get(&ac::attrs::LAUNCHER_GROUP2).copied(),
            launcher_group3: attr_id_key_map.get(&ac::attrs::LAUNCHER_GROUP3).copied(),
            launcher_group4: attr_id_key_map.get(&ac::attrs::LAUNCHER_GROUP4).copied(),
            launcher_group5: attr_id_key_map.get(&ac::attrs::LAUNCHER_GROUP5).copied(),
            launcher_group6: attr_id_key_map.get(&ac::attrs::LAUNCHER_GROUP6).copied(),
            launcher_slots_left: attr_id_key_map.get(&ac::attrs::LAUNCHER_SLOTS_LEFT).copied(),
            low_slots: attr_id_key_map.get(&ac::attrs::LOW_SLOTS).copied(),
            lowsec_modifier: attr_id_key_map.get(&ac::attrs::LOWSEC_MODIFIER).copied(),
            mass: attr_id_key_map.get(&ac::attrs::MASS).copied(),
            max_active_drones: attr_id_key_map.get(&ac::attrs::MAX_ACTIVE_DRONES).copied(),
            max_directional_scan_range: attr_id_key_map.get(&ac::attrs::MAX_DIRECTIONAL_SCAN_RANGE).copied(),
            max_fof_tgt_range: attr_id_key_map.get(&ac::attrs::MAX_FOF_TGT_RANGE).copied(),
            max_group_active: attr_id_key_map.get(&ac::attrs::MAX_GROUP_ACTIVE).copied(),
            max_group_fitted: attr_id_key_map.get(&ac::attrs::MAX_GROUP_FITTED).copied(),
            max_group_online: attr_id_key_map.get(&ac::attrs::MAX_GROUP_ONLINE).copied(),
            max_locked_targets: attr_id_key_map.get(&ac::attrs::MAX_LOCKED_TARGETS).copied(),
            max_range: attr_id_key_map.get(&ac::attrs::MAX_RANGE).copied(),
            max_subsystems: attr_id_key_map.get(&ac::attrs::MAX_SUBSYSTEMS).copied(),
            max_target_range: attr_id_key_map.get(&ac::attrs::MAX_TARGET_RANGE).copied(),
            max_type_fitted: attr_id_key_map.get(&ac::attrs::MAX_TYPE_FITTED).copied(),
            max_velocity: attr_id_key_map.get(&ac::attrs::MAX_VELOCITY).copied(),
            med_slots: attr_id_key_map.get(&ac::attrs::MED_SLOTS).copied(),
            mining_amount: attr_id_key_map.get(&ac::attrs::MINING_AMOUNT).copied(),
            mining_crit_bonus_yield: attr_id_key_map.get(&ac::attrs::MINING_CRIT_BONUS_YIELD).copied(),
            mining_crit_chance: attr_id_key_map.get(&ac::attrs::MINING_CRIT_CHANCE).copied(),
            mining_waste_probability: attr_id_key_map.get(&ac::attrs::MINING_WASTE_PROBABILITY).copied(),
            mining_wasted_volume_mult: attr_id_key_map.get(&ac::attrs::MINING_WASTED_VOLUME_MULT).copied(),
            mod_reactivation_delay: attr_id_key_map.get(&ac::attrs::MOD_REACTIVATION_DELAY).copied(),
            nos_override: attr_id_key_map.get(&ac::attrs::NOS_OVERRIDE).copied(),
            nullsec_modifier: attr_id_key_map.get(&ac::attrs::NULLSEC_MODIFIER).copied(),
            online_max_security_class: attr_id_key_map.get(&ac::attrs::ONLINE_MAX_SECURITY_CLASS).copied(),
            optimal_sig_radius: attr_id_key_map.get(&ac::attrs::OPTIMAL_SIG_RADIUS).copied(),
            pilot_security_status: attr_id_key_map.get(&ac::attrs::PILOT_SECURITY_STATUS).copied(),
            power: attr_id_key_map.get(&ac::attrs::POWER).copied(),
            power_output: attr_id_key_map.get(&ac::attrs::POWER_OUTPUT).copied(),
            power_transfer_amount: attr_id_key_map.get(&ac::attrs::POWER_TRANSFER_AMOUNT).copied(),
            radius: attr_id_key_map.get(&ac::attrs::RADIUS).copied(),
            recharge_rate: attr_id_key_map.get(&ac::attrs::RECHARGE_RATE).copied(),
            reload_time: attr_id_key_map.get(&ac::attrs::RELOAD_TIME).copied(),
            remote_resist_id: attr_id_key_map.get(&ac::attrs::REMOTE_RESIST_ID).copied(),
            rep_mult_bonus_max: attr_id_key_map.get(&ac::attrs::REP_MULT_BONUS_MAX).copied(),
            rep_mult_bonus_per_cycle: attr_id_key_map.get(&ac::attrs::REP_MULT_BONUS_PER_CYCLE).copied(),
            required_thermodynamics_skill: attr_id_key_map.get(&ac::attrs::REQUIRED_THERMODYNAMICS_SKILL).copied(),
            resist_shift_amount: attr_id_key_map.get(&ac::attrs::RESIST_SHIFT_AMOUNT).copied(),
            rig_size: attr_id_key_map.get(&ac::attrs::RIG_SIZE).copied(),
            scan_gravimetric_strength: attr_id_key_map.get(&ac::attrs::SCAN_GRAVIMETRIC_STRENGTH).copied(),
            scan_gravimetric_strength_bonus: attr_id_key_map
                .get(&ac::attrs::SCAN_GRAVIMETRIC_STRENGTH_BONUS)
                .copied(),
            scan_ladar_strength: attr_id_key_map.get(&ac::attrs::SCAN_LADAR_STRENGTH).copied(),
            scan_ladar_strength_bonus: attr_id_key_map.get(&ac::attrs::SCAN_LADAR_STRENGTH_BONUS).copied(),
            scan_magnetometric_strength: attr_id_key_map.get(&ac::attrs::SCAN_MAGNETOMETRIC_STRENGTH).copied(),
            scan_magnetometric_strength_bonus: attr_id_key_map
                .get(&ac::attrs::SCAN_MAGNETOMETRIC_STRENGTH_BONUS)
                .copied(),
            scan_radar_strength: attr_id_key_map.get(&ac::attrs::SCAN_RADAR_STRENGTH).copied(),
            scan_radar_strength_bonus: attr_id_key_map.get(&ac::attrs::SCAN_RADAR_STRENGTH_BONUS).copied(),
            scan_resolution: attr_id_key_map.get(&ac::attrs::SCAN_RESOLUTION).copied(),
            security_modifier: attr_id_key_map.get(&ac::attrs::SECURITY_MODIFIER).copied(),
            service_slots: attr_id_key_map.get(&ac::attrs::SERVICE_SLOTS).copied(),
            shield_bonus: attr_id_key_map.get(&ac::attrs::SHIELD_BONUS).copied(),
            shield_capacity: attr_id_key_map.get(&ac::attrs::SHIELD_CAPACITY).copied(),
            shield_em_dmg_resonance: attr_id_key_map.get(&ac::attrs::SHIELD_EM_DMG_RESONANCE).copied(),
            shield_expl_dmg_resonance: attr_id_key_map.get(&ac::attrs::SHIELD_EXPL_DMG_RESONANCE).copied(),
            shield_kin_dmg_resonance: attr_id_key_map.get(&ac::attrs::SHIELD_KIN_DMG_RESONANCE).copied(),
            shield_recharge_rate: attr_id_key_map.get(&ac::attrs::SHIELD_RECHARGE_RATE).copied(),
            shield_therm_dmg_resonance: attr_id_key_map.get(&ac::attrs::SHIELD_THERM_DMG_RESONANCE).copied(),
            sig_radius: attr_id_key_map.get(&ac::attrs::SIG_RADIUS).copied(),
            skill_level: attr_id_key_map.get(&ac::attrs::SKILL_LEVEL).copied(),
            speed_boost_factor: attr_id_key_map.get(&ac::attrs::SPEED_BOOST_FACTOR).copied(),
            speed_factor: attr_id_key_map.get(&ac::attrs::SPEED_FACTOR).copied(),
            struct_dmg_amount: attr_id_key_map.get(&ac::attrs::STRUCT_DMG_AMOUNT).copied(),
            subsystem_slot: attr_id_key_map.get(&ac::attrs::SUBSYSTEM_SLOT).copied(),
            therm_dmg: attr_id_key_map.get(&ac::attrs::THERM_DMG).copied(),
            therm_dmg_resonance: attr_id_key_map.get(&ac::attrs::THERM_DMG_RESONANCE).copied(),
            turret_slots_left: attr_id_key_map.get(&ac::attrs::TURRET_SLOTS_LEFT).copied(),
            upgrade_capacity: attr_id_key_map.get(&ac::attrs::UPGRADE_CAPACITY).copied(),
            upgrade_cost: attr_id_key_map.get(&ac::attrs::UPGRADE_COST).copied(),
            upgrade_slots_left: attr_id_key_map.get(&ac::attrs::UPGRADE_SLOTS_LEFT).copied(),
            volume: attr_id_key_map.get(&ac::attrs::VOLUME).copied(),
            warp_capacitor_need: attr_id_key_map.get(&ac::attrs::WARP_CAPACITOR_NEED).copied(),
            warp_scramble_status: attr_id_key_map.get(&ac::attrs::WARP_SCRAMBLE_STATUS).copied(),
            warp_speed_mult: attr_id_key_map.get(&ac::attrs::WARP_SPEED_MULT).copied(),
            // Derived data
            limited_precision,
            buff_merge_ids_strs: buff_merge_id_str,
            buff_merge_ids: buff_merge_id,
        }
    }
}
